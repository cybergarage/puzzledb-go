== MongoDB Compatibility

PuzzleDB supports a MongoDB API via https://github.com/cybergarage/go-mongo[go-mongo], a framework for implementing MongoDBâ€‘compatible servers in Go.

image::https://raw.githubusercontent.com/cybergarage/go-mongo/master/doc/img/framework.png[]

The framework handles protocol and system commands; PuzzleDB focuses on implementing user query commands.

=== Data Model

PuzzleDB converts MongoDB's https://bsonspec.org/[BSON] model into its internal representation:

[format="csv", options="header, autowidth"]
|====
include::model/mongodb.csv[]
|====

=== Supported Commands

PuzzleDB incrementally supports https://www.mongodb.com/docs/manual/reference/command/[MongoDB database commands]. Current status:

==== Diagnostic Commands

[format="csv", options="header, autowidth"]
|====
include::mongo/diagnostic.csv[]
|====

==== Replication Commands

[format="csv", options="header, autowidth"]
|====
include::mongo/replication.csv[]
|====

==== Query and Write Operation Commands

[format="csv", options="header, autowidth"]
|====
include::mongo/query.csv[]
|====

=== Indexing

Currently PuzzleDB automatically indexes all single fields of inserted and updated documents (similar to CosmosDB). Future versions will allow selective indexing and more adaptive strategies.

=== References

- https://learn.microsoft.com/en-us/azure/cosmos-db/whitepapers[Conceptual whitepapers - Azure Cosmos DB | Microsoft Learn]
- https://learn.microsoft.com/en-us/azure/cosmos-db/index-policy[Azure Cosmos DB indexing policies | Microsoft Learn]
- https://www.microsoft.com/en-us/research/publication/schema-agnostic-indexing-azure-documentdb/[Schema-Agnostic Indexing with Azure DocumentDB]
- https://learn.microsoft.com/en-us/azure/cosmos-db/mongodb/indexing[Manage indexing in Azure Cosmos DB for MongoDB | Microsoft Learn]